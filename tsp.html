<!DOCTYPE html>
<html>
<head>
		<title>ALGORITHM</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}" />
	</head>
<body>

   <!-- Main -->
				<div id="main">
					<div class="inner">
					<!-- Boxes -->

                    		<div class="box">
								<div class="inner">
									<h3>Traveling Salesman Problem Example</h3>
                                    
                                    <p><a href="/" class="button style3">Go to homepage</a><p>
									<a href="https://www.ise.vt.edu/about/news/2016/fall/subhash-sarin-fund-usda-doe-brdi.html" class="button style2">Read description</a> 
                                    
								</div>
							</div>

                        
						<div class="thumbnails">
                        
							<div class="box">
								<div class="inner">
									<h3>Input</h3>       
                                    <p> Enter number of cities</p>
									<form method="POST">
									   <input required type="text" name="num_cities" 
                                              placeholder="integer, valid range [3,99]" pattern="\b([3-9]|[1-8][0-9]|9[0-9])\b" oninvalid="this.setCustomValidity('integer, valid range [3,99]')" oninput="this.setCustomValidity('')">
                                       <br>
                                       <input type="submit">
                                       <input type="reset" value="Reset" onclick="localStorage.removeItem('tsp_result');display_result();" class="style3">
                                    </form>   
								</div>
							</div>
                            
							<div class="box">
								<div class="inner">
									<h3>Summary of Results</h3>                       
                                        <p><div id="summary"></div></p>
                                        <div id="detail"><p><a href='/tsp/detail/' class="button">Detail</a></p></div>
								</div>
							</div>
                            
                        </div>
                        
					</div>
				</div>
  
        
        
        <script>
             function store_result() {
                if(typeof(Storage) !== "undefined") {
                    {% if result %} 
                        localStorage.setItem('tsp_result', JSON.stringify({{ result|tojson|safe }})); 
                    {% endif %} 
                } else {
                    window.alert("Sorry, your browser does not support local storage...");
                }
             }
        
            function display_result() {
                if(typeof(Storage) !== "undefined") {
                    var summary_div = document.getElementById("summary");
                    var detail_div = document.getElementById("detail");
                    if (localStorage.tsp_result) {
                        var res = JSON.parse(localStorage.tsp_result);
                        summary_div.innerHTML += 'num_cities = ' + res.num_cities;
                        summary_div.innerHTML += '<br>obj = ' + res.obj;
                        summary_div.innerHTML += '<br>runtime = ' + res.runtime;
                        detail_div.style.display = "block";
                    } else {
                        summary_div.innerHTML = '';
                        detail_div.style.display = "none";
                    }
                } else {
                    window.alert("Sorry, your browser does not support local storage...");
                }
            }
            
            store_result()
            display_result()
        </script> 
         
        
	</body>
</html>